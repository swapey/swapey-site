<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Swapey DEX | Direct Swap</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">

<style>
body {
  margin:0;
  background:#16002d;
  font-family:'Luckiest Guy', cursive;
  color:white;
  text-align:center;
}

/* --- Top buttons --- */
#top-right {
  position: fixed;
  top:12px;
  right:12px;
  display:flex;
  align-items:center;
  gap:10px;
  z-index:10;
}
#top-right img {
  width:40px;
  cursor:pointer;
  transition: transform 0.2s ease;
}
#top-right img:hover { transform: scale(1.2) rotate(-10deg); }
#top-right a.btn-history {
  background: linear-gradient(135deg,#40E0D0,#8F5BFF);
  color:white;
  padding:10px 18px;
  border-radius:16px;
  text-decoration:none;
  font-weight:bold;
  transition:all 0.2s;
}
#top-right a.btn-history:hover { transform: scale(1.1); }
#top-right small { display:block; font-size:0.65rem; opacity:0.7; }

/* --- Wallet dashboard --- */
#wallet-dashboard {
  position: fixed;
  top:70px;
  right:12px;
  width:220px;
  padding:12px;
  background: rgba(64,224,208,0.15);
  border-radius:16px;
  text-align:left;
  box-shadow: 0 0 20px #40E0D0,0 0 40px #8F5BFF;
  color:white;
  font-family:'Luckiest Guy', cursive;
  font-size:0.9rem;
}
#wallet-status { font-weight:bold; margin-bottom:6px; }
#wallet-balance { margin-bottom:6px; }
#wallet-tokens { max-height:200px; overflow-y:auto; }

/* --- Header --- */
header { padding:60px 20px 20px; }
header img { width:520px; max-width:92%; margin-bottom:20px; }
h1 { font-size:3.4rem; margin:10px 0; }
p { font-size:1.2rem; color:#ffffffcc; max-width:720px; margin:auto; }

/* --- Countdown --- */
#event-countdown { font-size:1.5rem; margin:20px 0; color:#40E0D0; font-weight:bold; }

/* --- Swap form --- */
.swap-form {
  margin:40px auto;
  width:420px;
  max-width:95%;
  padding:20px;
  border-radius:24px;
  background: rgba(0,0,0,0.25);
  box-shadow:0 0 40px rgba(64,224,208,0.5),0 0 40px rgba(143,91,255,0.5);
  text-align:left;
}
.swap-form label { display:block; margin:10px 0 5px; }
.swap-form input, .swap-form select {
  width:100%; padding:8px; border-radius:12px; border:none; font-size:1rem;
  font-family:'Luckiest Guy', cursive;
  color:#fff;
  background: linear-gradient(135deg,#3DD9D9,#8F5BFF);
  text-shadow: 1px1px 2px #000;
}
.swap-form select option { color:#000; background:#fff; }

/* --- Swap button --- */
.btn-cartoon {
  background: linear-gradient(135deg, #40E0D0, #8F5BFF);
  border: 4px solid #fff;
  color: #fff;
  font-weight: bold;
  font-size: 1.2rem;
  padding: 18px 36px;
  margin: 12px 0;
  border-radius: 24px;
  cursor: pointer;
  text-transform: uppercase;
  box-shadow: 0 0 12px #40E0D0, 0 0 24px #8F5BFF, 0 0 36px #40E0D0;
  transition: all 0.3s ease-in-out;
}
.btn-cartoon:hover { transform: scale(1.15) rotate(-2deg); box-shadow:0 0 24px #40E0D0,0 0 48px #8F5BFF,0 0 72px #40E0D0; }
.btn-cartoon:active { transform: scale(0.95) rotate(1deg); box-shadow:0 0 10px #40E0D0,0 0 20px #8F5BFF,0 0 30px #40E0D0; }

/* --- Popup confirmation --- */
#confirm {
  position:fixed;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  background: linear-gradient(135deg, #40E0D0, #8F5BFF);
  padding:16px 32px;
  border-radius:16px;
  font-weight:bold;
  color:black;
  font-size:1.2rem;
  display:none;
  box-shadow:0 0 25px #40E0D0,0 0 50px #8F5BFF;
  animation: flash 0.5s ease-in-out;
}
@keyframes flash { 0% { transform: translateX(-50%) scale(0.8); opacity:0; } 50% { transform: translateX(-50%) scale(1.1); opacity:1; } 100% { transform: translateX(-50%) scale(1); opacity:1; } }

/* --- Crypto News Box --- */
.announcement-box {
  margin:40px auto;
  width:90%;
  max-width:720px;
  padding:16px 24px;
  border-radius:16px;
  background: rgba(64,224,208,0.15);
  border:2px solid #40E0D0;
  text-align:left;
  color:white;
  box-shadow:0 0 20px #40E0D0,0 0 40px #8F5BFF;
}
.announcement-box h2 { text-align:center; font-size:1.6rem; margin-bottom:12px; }
.announcement-box ul { list-style:none; padding:0; margin:0; max-height:150px; overflow-y:auto; }
.announcement-box li { margin-bottom:6px; font-size:1rem; }

/* --- Footer --- */
footer { margin:40px 0; font-size:0.75rem; opacity:0.6; text-align:center; }
</style>
</head>
<body>

<div id="top-right">
  <img src="metamask-fox.png" onclick="connectMetaMask()" alt="MetaMask" />
  <img src="phantom-logo.png" onclick="connectPhantom()" alt="Phantom" />
  <a href="history.html" class="btn-history">History</a>
  <small>Polygon Network only</small>
</div>

<div id="wallet-dashboard">
  <div id="wallet-status">Not connected</div>
  <div id="wallet-balance"></div>
  <div id="wallet-tokens"></div>
</div>

<header>
  <img src="swapey-logo.png" alt="Swapey Logo" />
  <h1>Swapey DEX</h1>
  <p>Swap hundreds of tokens instantly on Polygon using Swapey interface.</p>
</header>

<div id="event-countdown">
  Announcement in: <span id="countdown">Loading...</span>
</div>

<div class="swap-form">
  <label>From Token:</label>
  <select id="tokenA">
    <!-- Top 50 Polygon tokens simplified example -->
    <option value="0x0000000000000000000000000000000000001010">MATIC</option>
    <option value="0x2791bca1f2de4661ed88a30c99a7a9449aa84174">USDC</option>
    <option value="0xc2132d05d31c914a87c6611c10748aeb04b58e8f">USDT</option>
    <option value="0x8f3cf7ad23cd3cadbd9735aff958023239c6a063">DAI</option>
    <option value="0x7ceb23fd6bc0add59e62ac25578270cff1b9f619">WETH</option>
    <!-- ajoute les autres tokens ici -->
  </select>

  <label>To Token:</label>
  <select id="tokenB">
    <option value="0x2791bca1f2de4661ed88a30c99a7a9449aa84174">USDC</option>
    <option value="0x8f3cf7ad23cd3cadbd9735aff958023239c6a063">DAI</option>
    <option value="0x0000000000000000000000000000000000001010">MATIC</option>
    <option value="0x7ceb23fd6bc0add59e62ac25578270cff1b9f619">WETH</option>
  </select>

  <label>Amount:</label>
  <input type="number" id="amount" placeholder="Enter amount" />
  <button class="btn-cartoon" onclick="swapTokens()">Swap</button>
  <div id="status" class="status"></div>
</div>

<div id="confirm">âœ… Swap Successful!</div>

<div class="announcement-box">
  <h2>Live Crypto News</h2>
  <ul id="crypto-news">
    <li>BTC surged 5% in the last hour!</li>
    <li>ETH staking rewards increase announced</li>
    <li>Polygon network upgrade soon</li>
    <li>New token listing on Swapey DEX!</li>
  </ul>
</div>

<footer>
  Swapey is decentralized. Use at your own risk.
</footer>

<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script>
// Wallet
let provider, signer;
async function connectMetaMask(){
  if(window.ethereum){
    provider=new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts",[]);
    signer=provider.getSigner();
    const address=await signer.getAddress();
    document.getElementById("wallet-status").innerText="MetaMask: "+address.slice(0,6)+"â€¦"+address.slice(-4);
    const balance=await provider.getBalance(address);
    document.getElementById("wallet-balance").innerText="MATIC: "+ethers.utils.formatEther(balance);
    // Token balances example
    const tokens=[{symbol:"USDC", addr:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174"}];
    let html="<ul>";
    for(const t of tokens){
      const tokenContract=new ethers.Contract(t.addr,["function balanceOf(address) view returns (uint256)"],provider);
      const bal=await tokenContract.balanceOf(address);
      html+=`<li>${t.symbol}: ${ethers.utils.formatUnits(bal,18)}</li>`;
    }
    html+="</ul>";
    document.getElementById("wallet-tokens").innerHTML=html;
  } else alert("MetaMask not detected");
}
async function connectPhantom(){
  if(window.solana && window.solana.isPhantom){
    const resp=await window.solana.connect();
    const publicKey=resp.publicKey.toString();
    document.getElementById("wallet-status").innerText="Phantom: "+publicKey.slice(0,4)+"â€¦"+publicKey.slice(-4);
    const solBalance=await window.solana.request({method:"getBalance"});
    document.getElementById("wallet-balance").innerText="SOL: "+(solBalance/1e9).toFixed(4);
    document.getElementById("wallet-tokens").innerHTML="<small>Tokens SPL will appear here</small>";
  } else alert("Phantom not detected");
}

// Swap (QuickSwap example)
async function swapTokens(){
  if(!signer){ alert("Connect wallet first"); return; }
  const tokenA=document.getElementById("tokenA").value;
  const tokenB=document.getElementById("tokenB").value;
  const amount=document.getElementById("amount").value;
  if(!amount||amount<=0){ alert("Enter a valid amount"); return; }
  const routerAddress="0xa5E0829CaCED8fFdd4De3c43696c57F7D7A678ff";
  const routerABI=["function swapExactTokensForTokens(uint amountIn,uint amountOutMin,address[] calldata path,address to,uint deadline) external returns (uint[] memory amounts)"];
  const router=new ethers.Contract(routerAddress,routerABI,signer);
  try{
    const path=[tokenA,tokenB];
    const to=await signer.getAddress();
    const deadline=Math.floor(Date.now()/1000)+60*20;
    const tx=await router.swapExactTokensForTokens(ethers.utils.parseUnits(amount,18),0,path,to,deadline);
    document.getElementById("status").innerText="Transaction sent: "+tx.hash;
    await tx.wait();
    const confirm=document.getElementById("confirm");
    confirm.style.display="block";
    setTimeout(()=>{confirm.style.display="none";},3500);
    document.getElementById("status").innerText="Swap successful: "+tx.hash;
  } catch(e){ console.error(e); document.getElementById("status").innerText="Swap failed: "+e.message; }
}

// Countdown
const eventDate=new Date("2026-01-26T20:00:00");
function updateCountdown(){
  const now=new Date();
  const diff=eventDate-now;
  if(diff<=0){ document.getElementById("countdown").innerText="The announcement is live! ðŸŽ‰"; clearInterval(countdownInterval); return; }
  const days=Math.floor(diff/(1000*60*60*24));
  const hours=Math.floor((diff/(1000*60*60))%24);
  const minutes=Math.floor((diff/(1000*60))%60);
  const seconds=Math.floor((diff/1000)%60);
  document.getElementById("countdown").innerText=`${days}d ${hours}h ${minutes}m ${seconds}s`;
}
updateCountdown();
const countdownInterval=setInterval(updateCountdown,1000);
</script>

</body>
</html>
