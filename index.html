<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Swapey DEX | Direct Swap</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">
<style>
body {margin:0;font-family:'Luckiest Guy',cursive;color:white;text-align:center;background:linear-gradient(270deg,#16002d,#2b004d,#4000a0,#16002d);background-size:800% 800%;animation:gradientBG 20s ease infinite;}
@keyframes gradientBG{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
#ticker {position: fixed; top:0; width:100%; text-align:center; background:#1a0033; color:#40E0D0; padding:6px; font-weight:bold; font-family:'Luckiest Guy', cursive; z-index:11;}
#top-right {position: fixed; top:32px; right:12px; z-index:10; display:flex; flex-direction:column; align-items:flex-end; gap:10px;}
#top-right img {width:40px; cursor:pointer; border:3px solid red; border-radius:50%; transition: all 0.3s ease;}
#top-right img.connected {border-color: #40E0D0;}
#top-right a.btn-history {background: linear-gradient(135deg,#40E0D0,#8F5BFF); color:white; padding:10px 18px; border-radius:16px; text-decoration:none; font-weight:bold; transition:all 0.2s;}
#top-right a.btn-history:hover {transform: scale(1.1);}
header {padding:60px 20px 20px; position:relative; z-index:1;}
header img {width:520px; max-width:92%; margin-bottom:20px;}
h1 {font-size:3.4rem; margin:10px 0;}
p {font-size:1.2rem; color:#ffffffcc; max-width:720px; margin:auto;}
#event-countdown {font-size:1.5rem; margin:20px 0; color:#40E0D0; font-weight:bold; position:relative; z-index:1;}
.swap-form {margin:40px auto; width:420px; max-width:95%; padding:20px; border-radius:24px; text-align:center; background: linear-gradient(135deg,#2a004f,#4d00a0); box-shadow:0 0 20px #40E0D0,0 0 40px #8F5BFF; position:relative; z-index:1;}
.swap-form select, .swap-form input {width:100%; padding:10px; border-radius:12px; border:none; font-size:1rem; font-family:'Luckiest Guy', cursive; text-align:center; margin:6px 0;}
.swap-form input {color:#000;}
#swapey-button {background:none; border:none; cursor:pointer; display:block; margin:20px auto; text-align:center; font-family:'Luckiest Guy', cursive; font-size:2.8rem; color:#ffffff; text-shadow:0 0 8px #40E0D0,0 0 16px #8F5BFF; transition: all 0.3s ease;}
#swapey-button:hover {transform: scale(1.1) rotate(-2deg); text-shadow:0 0 12px #40E0D0,0 0 24px #8F5BFF;}
#confirm {position:fixed; top:60px; left:50%; transform:translateX(-50%); background: linear-gradient(135deg,#40E0D0,#8F5BFF); padding:16px 32px; border-radius:16px; font-weight:bold; color:black; font-size:1.2rem; display:none; box-shadow:0 0 25px #40E0D0,0 0 50px #8F5BFF; animation: flash 0.5s ease-in-out;}
@keyframes flash {0% { transform: translateX(-50%) scale(0.8); opacity:0; } 50% { transform: translateX(-50%) scale(1.1); opacity:1; } 100% { transform: translateX(-50%) scale(1); opacity:1; }}
#wallet-dashboard {position: fixed; top:80px; right:12px; width:260px; padding:12px; background: rgba(64,224,208,0.1); border-radius:16px; text-align:left; box-shadow:0 0 20px #40E0D0,0 0 40px #8F5BFF; font-family:'Luckiest Guy', cursive; font-size:0.9rem; z-index:10;}
#wallet-tokens {max-height:280px; overflow-y:auto;}
.announcement-box {margin:40px auto; width:90%; max-width:720px; padding:16px 24px; border-radius:16px; background: rgba(64,224,208,0.15); border:2px solid #40E0D0; text-align:left; color:white; box-shadow:0 0 20px #40E0D0,0 0 40px #8F5BFF; position:relative; z-index:1;}
.announcement-box h2 {text-align:center; font-size:1.6rem; margin-bottom:12px;}
.announcement-box ul {list-style:none; padding:0; margin:0; max-height:150px; overflow-y:auto;}
.announcement-box li {margin-bottom:6px; font-size:1rem;}
footer {margin:40px 0; font-size:0.75rem; opacity:0.6; text-align:center; position:relative; z-index:1;}
</style>
</head>
<body>

<div id="ticker">Loading crypto prices...</div>

<div id="top-right">
  <a href="history.html" class="btn-history">History</a>
  <img id="phantom-logo" src="phantom-logo.png" alt="Phantom" onclick="togglePhantom()"/>
</div>

<div id="wallet-dashboard">
  <div id="wallet-tokens"></div>
</div>

<header>
  <img src="swapey-logo.png" alt="Swapey Logo"/>
  <h1>Swapey DEX</h1>
  <p>Swap hundreds of tokens instantly on Polygon using Swapey interface.</p>
</header>

<div id="event-countdown">
  Announcement in: <span id="countdown">Loading...</span>
</div>

<div class="swap-form">
  <select id="token-from"></select>
  <input type="number" id="amount" placeholder="Enter amount"/>
  <select id="token-to"></select>
  <button id="swapey-button" onclick="swapTokens()">Swapey</button>
</div>

<div id="confirm">‚úÖ Swap Successful!</div>

<div class="announcement-box">
  <h2>Live Crypto News</h2>
  <ul id="crypto-news">
    <li>BTC surged 5% in the last hour!</li>
    <li>ETH staking rewards increase announced</li>
    <li>Polygon network upgrade soon</li>
    <li>New token listing on Swapey DEX!</li>
  </ul>
</div>

<footer>Swapey is decentralized. Use at your own risk.</footer>

<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script src="https://unpkg.com/@solana/web3.js@1.73.0/lib/index.iife.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@solana/spl-token-registry@0.2.10/dist/index.iife.js"></script>
<script>
// ----- Tokens (exemple partiel 100) -----
const polygonTokens = [
  {symbol:"MATIC", addr:"0x0000000000000000000000000000000000001010"},
  {symbol:"USDC", addr:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174"},
  {symbol:"USDT", addr:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f"}
  // ajouter les 97 restants
];

// Populate selects
function populateTokenSelects(){
  const from=document.getElementById("token-from");
  const to=document.getElementById("token-to");
  from.innerHTML=""; to.innerHTML="";
  polygonTokens.forEach(t=>{
    from.innerHTML+=`<option value="${t.addr}">${t.symbol}</option>`;
    to.innerHTML+=`<option value="${t.addr}">${t.symbol}</option>`;
  });
}
populateTokenSelects();

let phantomConnected=false;
async function togglePhantom(){
  const logo=document.getElementById("phantom-logo");
  if(!phantomConnected){
    if(window.solana && window.solana.isPhantom){
      const resp = await window.solana.connect();
      const pubKey = resp.publicKey;
      logo.classList.add("connected");
      phantomConnected=true;
      // Connection Sol
      const connection=new solanaWeb3.Connection(solanaWeb3.clusterApiUrl("mainnet-beta"));
      const solBalance=await connection.getBalance(pubKey);
      const tokensDiv=document.getElementById("wallet-tokens");
      tokensDiv.innerHTML=`<ul><li>SOL: ${(solBalance/1e9).toFixed(4)}</li></ul>`;
      // SPL tokens balances √† compl√©ter si n√©cessaire
    } else alert("Phantom not detected");
  } else {
    window.solana.disconnect();
    logo.classList.remove("connected");
    phantomConnected=false;
    document.getElementById("wallet-tokens").innerHTML="";
  }
}

// Countdown
const eventDate=new Date("2026-01-26T20:00:00");
function updateCountdown(){
  const now=new Date();
  const diff=eventDate-now;
  if(diff<=0){ document.getElementById("countdown").innerText="The announcement is live! üéâ"; clearInterval(countdownInterval); return; }
  const days=Math.floor(diff/(1000*60*60*24));
  const hours=Math.floor((diff/(1000*60*60))%24);
  const minutes=Math.floor((diff/(1000*60))%60);
  const seconds=Math.floor((diff/1000)%60);
  document.getElementById("countdown").innerText=`${days}d ${hours}h ${minutes}m ${seconds}s`;
}
updateCountdown();
const countdownInterval=setInterval(updateCountdown,1000);

// Swapey Swap
function swapTokens(){
  const amount=document.getElementById("amount").value;
  if(!amount||amount<=0){ alert("Enter a valid amount"); return; }
  const confirm=document.getElementById("confirm");
  confirm.style.display="block";
  setTimeout(()=>{confirm.style.display="none";},3500);
}

// Ticker CoinGecko
async function updateTicker(){
  const resp=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana&vs_currencies=usd");
  const data=await resp.json();
  document.getElementById("ticker").innerText = 
    `BTC: $${data.bitcoin.usd} | ETH: $${data.ethereum.usd} | SOL: $${data.solana.usd}`;
}
updateTicker();
setInterval(updateTicker,10000);
</script>
</body>
</html>
