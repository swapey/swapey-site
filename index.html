<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Swapey DEX | Direct Swap</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  background: radial-gradient(circle at top, #8f5bff, #16002d);
  font-family: 'Comic Sans MS', 'Trebuchet MS', Arial, sans-serif;
  color: white;
  text-align: center;
}
header {
  padding: 60px 20px 20px;
}
img {
  width: 520px;
  max-width: 92%;
  margin-bottom: 20px;
}
h1 { font-size: 3.4rem; margin: 10px 0; }
p { opacity: 0.85; max-width: 720px; margin: auto; }

.warning {
  background: rgba(255, 165, 0, 0.15);
  border: 1px solid orange;
  padding: 12px;
  border-radius: 12px;
  margin: 30px auto;
  width: fit-content;
}

.wallet { margin: 30px auto; }
.btn-gaming {
  background: linear-gradient(135deg, #ff7b00, #ffb347);
  border: 2px solid #fff;
  color: #fff;
  font-weight: bold;
  font-size: 1.1rem;
  padding: 16px 32px;
  margin: 10px;
  border-radius: 16px;
  cursor: pointer;
  text-transform: uppercase;
  box-shadow: 0 0 10px #ff7b00, 0 0 20px #ffb347, 0 0 30px #ff7b00;
  transition: all 0.3s ease-in-out;
}
.btn-gaming:hover {
  transform: scale(1.1);
  box-shadow: 0 0 20px #ff7b00, 0 0 40px #ffb347, 0 0 60px #ff7b00;
}
.btn-gaming:active {
  transform: scale(0.95);
  box-shadow: 0 0 5px #ff7b00, 0 0 10px #ffb347, 0 0 15px #ff7b00;
}

.swap-form {
  margin: 40px auto;
  width: 420px;
  max-width: 95%;
  padding: 20px;
  border-radius: 24px;
  background: rgba(0,0,0,0.25);
  box-shadow: 0 0 40px rgba(255,123,0,0.5);
  text-align: left;
}

.swap-form label { display: block; margin: 10px 0 5px; }
.swap-form input, .swap-form select {
  width: 100%; padding: 8px; border-radius: 12px; border: none; font-size: 1rem;
}

.address, .status {
  margin-top: 10px; font-size: 0.85rem; opacity: 0.85; word-break: break-all;
}

/* Confirmation popup */
#confirm {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, #ff7b00, #ffb347);
  padding: 16px 32px;
  border-radius: 16px;
  font-weight: bold;
  color: black;
  font-size: 1.2rem;
  display: none;
  box-shadow: 0 0 25px #ffb347, 0 0 50px #ff7b00;
  animation: flash 0.5s ease-in-out;
}

/* Flash animation */
@keyframes flash {
  0% { transform: translateX(-50%) scale(0.8); opacity: 0; }
  50% { transform: translateX(-50%) scale(1.1); opacity: 1; }
  100% { transform: translateX(-50%) scale(1); opacity: 1; }
}

footer { margin: 40px 0; font-size: 0.75rem; opacity: 0.6; text-align:center; }
</style>
</head>

<body>

<header>
  <img src="swapey-logo.png" alt="Swapey Logo" />
  <h1>Swapey DEX</h1>
  <p>Swap hundreds of tokens instantly on Polygon using Swapey interface.</p>
</header>

<div class="warning">⚠️ Polygon Network only</div>

<div class="wallet">
  <button class="btn-gaming" onclick="connectWallet()">Connect MetaMask</button>
  <div id="address" class="address"></div>
</div>

<div class="swap-form">
  <label>From Token:</label>
  <select id="tokenA">
    <option value="0x0000000000000000000000000000000000001010">MATIC</option>
    <option value="0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174">USDC</option>
    <option value="0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063">DAI</option>
    <option value="0x7ceB23fD6bC0adD59E62ac25578270cFf1b9f619">WETH</option>
    <option value="0x1BFD67037B42Cf73acF2047067bd4F2C47D9BfD6">WBTC</option>
    <option value="0x831753DD7087CaC61aB5644b308642cc1c33Dc13">QUICK</option>
    <option value="0xdAC17F958D2ee523a2206206994597C13D831ec7">USDT</option>
    <option value="0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270">WMATIC</option>
    <option value="0x3a9fE7886cCb8102bbF7b815Aea46C56b5f0fEa5">AAVE</option>
    <option value="0x5947BB275c521040051D82396192181b413227A3">LINK</option>
    <option value="0x853d955aCEf822Db058eb8505911ED77F175b99e">FRAX</option>
    <option value="0xa1d65E8fB6e87b60FECCBcE0bdAfc0f632dbD58B">FOX</option>
    <option value="0x172370d5Cd63279eFa6d502DAB29171933a610AF">CRV</option>
    <option value="0x1F35F5d78C84a92c67cf2af2ce77DdA281F8e5e8">BAL</option>
    <option value="0x1BD38C1BB2D6378f16C0CE1cBb058aD81e95d3c9">SUSHI</option>
    <option value="0x9B71dbF9448B2f26fC96875AC0cC741e9BBaB75B">MANA</option>
    <option value="0x9A494523A474c7C1f9079fAb5F12C3c2F42D91B9">CHZ</option>
    <!-- Tu peux ajouter encore plus ici si tu veux -->
  </select>

  <label>To Token:</label>
  <select id="tokenB">
    <option value="0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174">USDC</option>
    <option value="0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063">DAI</option>
    <option value="0x0000000000000000000000000000000000001010">MATIC</option>
    <option value="0x7ceB23fD6bC0adD59E62ac25578270cFf1b9f619">WETH</option>
    <option value="0x1BFD67037B42Cf73acF2047067bd4F2C47D9BfD6">WBTC</option>
    <option value="0x831753DD7087CaC61aB5644b308642cc1c33Dc13">QUICK</option>
    <option value="0xdAC17F958D2ee523a2206206994597C13D831ec7">USDT</option>
    <option value="0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270">WMATIC</option>
    <option value="0x3a9fE7886cCb8102bbF7b815Aea46C56b5f0fEa5">AAVE</option>
    <option value="0x5947BB275c521040051D82396192181b413227A3">LINK</option>
    <option value="0x853d955aCEf822Db058eb8505911ED77F175b99e">FRAX</option>
    <option value="0xa1d65E8fB6e87b60FECCBcE0bdAfc0f632dbD58B">FOX</option>
    <option value="0x172370d5Cd63279eFa6d502DAB29171933a610AF">CRV</option>
    <option value="0x1F35F5d78C84a92c67cf2af2ce77DdA281F8e5e8">BAL</option>
    <option value="0x1BD38C1BB2D6378f16C0CE1cBb058aD81e95d3c9">SUSHI</option>
    <option value="0x9B71dbF9448B2f26fC96875AC0cC741e9BBaB75B">MANA</option>
    <option value="0x9A494523A474c7C1f9079fAb5F12C3c2F42D91B9">CHZ</option>
    <!-- Copie pareil pour le reste des tokens -->
  </select>

  <label>Amount:</label>
  <input type="number" id="amount" placeholder="Enter amount" />

  <button class="btn-gaming" onclick="swapTokens()">Swap</button>
  <div id="status" class="status"></div>
</div>

<div id="confirm">✅ Swap Successful!</div>

<footer>
  Swapey is decentralized. Use at your own risk.
</footer>

<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script>
let provider, signer;

async function connectWallet() {
  if(window.ethereum){
    provider = new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    const address = await signer.getAddress();
    document.getElementById("address").innerText = "Connected: " + address;
    document.getElementById("status").innerText = "";
  } else {
    alert("MetaMask not detected");
  }
}

async function swapTokens(){
  if(!signer){
    alert("Connect MetaMask first");
    return;
  }

  const tokenA = document.getElementById("tokenA").value;
  const tokenB = document.getElementById("tokenB").value;
  const amount = document.getElementById("amount").value;

  if(!amount || amount <=0){
    alert("Enter a valid amount");
    return;
  }

  const routerAddress = "0xa5E0829CaCED8fFdd4De3c43696c57F7D7A678ff"; 
  const routerABI = [
    "function swapExactTokensForTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)"
  ];
  const router = new ethers.Contract(routerAddress, routerABI, signer);

  try{
    const path = [tokenA, tokenB];
    const to = await signer.getAddress();
    const deadline = Math.floor(Date.now()/1000) + 60*20;

    const tx = await router.swapExactTokensForTokens(
      ethers.utils.parseUnits(amount, 18),
      0,
      path,
      to,
      deadline
    );
    document.getElementById("status").innerText = "Transaction sent: " + tx.hash;

    await tx.wait();

    // Affichage confirmation avec flash
    const confirm = document.getElementById("confirm");
    confirm.style.display = "block";
    setTimeout(()=>{ confirm.style.display = "none"; }, 3500);

    document.getElementById("status").innerText = "Swap successful: " + tx.hash;
  } catch(e){
    console.error(e);
    document.getElementById("status").innerText = "Swap failed: " + e.message;
  }
}
</script>

</body>
</html>
